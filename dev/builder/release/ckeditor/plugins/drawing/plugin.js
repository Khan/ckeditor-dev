(function(){var f={_:function(b){return b}},m=f._("Drawing"),p=f._("Add Drawing"),n=f._("Click to edit");CKEDITOR.env.ie&&(n=f._("Double-click to edit"));var k="/computer-programming/method_draw",l=/^data:image\/svg\+xml;.*?,/i,o=CKEDITOR.env.safari,i,j=function(b){return b.getAttribute&&b.getAttribute("src")?l.test(b.getAttribute("src")):b.attributes&&b.attributes.src?l.test(b.attributes.src):!1};CKEDITOR.plugins.add("drawing",{requires:"dialog,iframedialog,htmlwriter",icons:"drawing",allowed:"img,iframe[!src,!width,!height]",
init:function(b){b.addCommand("drawing",new CKEDITOR.dialogCommand("drawing"));b.ui.addButton(m,{label:p,command:"drawing"});b.on("contentDom",function(){var a,e=b.editable(),c=e.$.ownerDocument,h=function(){a&&(a.parentNode.removeChild(a),a=null)};e.on("mouseover",function(e){var g=e.data.$.target;a&&g!==a&&h();!a&&j(g)&&(a=c.createElement("div"),a.className="svg-overlay",a.setAttribute("contenteditable","false"),a.style.width=g.offsetWidth+"px",a.style.height=g.offsetHeight+"px",a.style.top=g.offsetTop,
a.style.left=g.offsetLeft,a.addEventListener("click",function(){i=new CKEDITOR.dom.element(g);b.execCommand("drawing")},!1),a.addEventListener("mouseout",h,!1),g.parentNode.insertBefore(a,g))});e.on("click",function(a){a=a.data.$.target;j(a)&&(i=new CKEDITOR.dom.element(a),b.execCommand("drawing"))})});if("undefined"!==typeof KAdefine){var e=KAdefine.require("./javascript/shared-package/ka.js");e.IS_DEV_SERVER||(k+="?v="+e.version)}CKEDITOR.dialog.addIframe("drawing",m,k,865,510,q(b))},afterInit:function(b){o&&
(b.dataProcessor.dataFilter.addRules({elements:{img:function(b){if(j(b)){var a=parseFloat(b.styles.width),d=parseFloat(b.styles.height);return new CKEDITOR.htmlParser.element("iframe",{src:b.attributes.src,width:a,height:d})}}}}),b.dataProcessor.htmlFilter.addRules({elements:{iframe:function(b){if(j(b))return new CKEDITOR.htmlParser.element("img",{src:b.attributes.src,width:b.attributes.width,height:b.attributes.height})}}}))},onLoad:function(){CKEDITOR.addCss(".svg-overlay {display: block;position: absolute;}.svg-overlay:hover::after {background: orange;color: #000;content: '"+
n+"';font-size: 12px;padding: 4px;position: absolute;right: 0;top: 0;}iframe[src^='data:image/svg+xml'] {border: none;}")}});var q=function(b){return function(){var e=this,a=this.getDialog(),d=a.getElement(),c=d.$.getElementsByClassName("cke_dialog_contents_body")[0];c.style.margin=0;c.style.padding=0;c.style.overflow="hidden";d.$.getElementsByClassName("cke_dialog_ui_vbox_child")[0].style.padding=0;d=this.getElement().$.contentWindow;if("undefined"!==typeof KAdefine&&(c=KAdefine.require("./javascript/shared-package/ka.js").getUserProfile(),
c.get("isCreator")||c.get("isDeveloper")))d.document.getElementById("file-menu").style.display="inline-block";var h=i;i=null;h&&(c=h.getAttribute("src").replace(l,""),c=decodeURIComponent(c),d.methodDraw.canvas.setSvgString(c));var f=function(){var a=e.getElement().$.contentWindow,c="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(a.methodDraw.canvas.getSvgString());var f=a.methodDraw.canvas.contentW,a=a.methodDraw.canvas.contentH,d=o?new CKEDITOR.dom.element("iframe"):new CKEDITOR.dom.element("img");
d.setAttributes({src:c,width:f,height:a});c=d;h?c.replace(h):b.insertElement(c)};a.on("ok",f);a.on("hide",function(b){a.removeListener("ok",f);b.removeListener()})}}})();