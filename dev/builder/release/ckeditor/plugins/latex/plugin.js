(function(){CKEDITOR.plugins.add("latex",{requires:"dialog",icons:"latex",init:function(b){b.addCommand("latex",new CKEDITOR.dialogCommand("latex",{allowedContent:"code(latex)"}));b.ui.addButton("LaTeX",{label:"LaTeX",command:"latex"});CKEDITOR.dialog.add("latex",c)}});var c=function(b){return{title:"Embed LaTeX",minWidth:300,minHeight:100,contents:[{id:"general",label:"Settings",elements:[{type:"textarea",id:"source",label:"TeX",validate:CKEDITOR.dialog.validate.notEmpty("The TeX field cannot be empty."),
required:!0,updatePreview:function(){var a=this.getDialog().getContentElement("general","preview");$(a.getElement().$).html("<code>"+this.getValue()+"</code>");$(a.getElement().$).tex()},setup:function(a){a&&this.setValue(a.getText());this.updatePreview()},commit:function(a){a.setText(this.getValue())},onShow:function(){this.updatePreview()},onKeyUp:function(){this.updatePreview()}},{type:"html",label:"Preview",id:"preview",html:""}]}],onShow:function(){this.codeNode=null;var a=this.getSelectedElement();
a||(a=this.getParentEditor().getSelection(),a=a.getSelectedElement()||a.getStartElement());a&&a.hasClass("latex")&&(this.setupContent(a),this.codeNode=a)},onOk:function(){var a=this.codeNode||new CKEDITOR.dom.element("code");this.commitContent(a);a.setAttributes({"class":"latex"});this.codeNode||b.insertElement(a)}}}})();